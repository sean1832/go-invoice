services:
  app:
    build: .
    container_name: go-invoice-app
    environment:
      - CHROME_REMOTE_URL=http://chrome:3000
      - CHROME_RENDER_URL=http://app:8080
      - STORAGE_PATH=/data
      - PORT=8080

      # # The full public URL where this server will be accessible. 
      # # This will be the callback URL for Google OAuth.
      # - PUBLIC_URL=http://localhost:8080 

      # # --------------------------------
      # # SESSION CONFIGURATION (Optional)
      # # --------------------------------
      # - IS_PROD="true" # Uncomment for production
      # - SESSION_SECRET="" # Set a secure session secret (openssl rand -base64 32)
      # - SESSION_MAX_AGE=2592000 # Optional: Session max age in seconds (default 30 days: 86400 * 30)

      # # --------------------------------
      # # EMAIL CONFIGURATION (Optional)
      # # --------------------------------
      # # --- METHOD 1: Google OAuth2 (Recommended) ---
      # - GOOGLE_OAUTH_CLIENT_ID=""
      # - GOOGLE_OAUTH_CLIENT_SECRET=""
      # - SMTP_HOST="smtp.gmail.com"
      # - SMTP_PORT=587

      # # --- METHOD 2: App Password (Simple, less secure) ---
      # - SMTP_FROM="" # e.g., your-email@gmail.com
      # - SMTP_PASSWORD="" # App Password generated in Google Account "https://myaccount.google.com/apppasswords"
      # - SMTP_HOST=smtp.gmail.com
      # - SMTP_PORT=587
    ports:
      - "8080:8080"
    volumes:
      - ./db:/data
    networks:
      - invoice-network
    depends_on:
      - chrome

  chrome:
    image: browserless/chrome:latest
    container_name: go-invoice-chrome
    environment:
      - CONNECTION_TIMEOUT=60000
    ports:
      - "9222:3000"
    networks:
      - invoice-network

networks:
  invoice-network:
    driver: bridge
